---
---

<script>
  // Scroll animation observer
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -100px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('animate-in');
        // Optional: unobserve after animation to improve performance
        // observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  // Observe all elements with scroll animation classes
  document.addEventListener('DOMContentLoaded', () => {
    const animatedElements = document.querySelectorAll(
      '.scroll-fade-in, .scroll-slide-up, .scroll-slide-left, .scroll-slide-right, .scroll-scale-in, .scroll-stagger'
    );
    
    animatedElements.forEach((el, index) => {
      // Add stagger delay for elements with scroll-stagger class
      if (el.classList.contains('scroll-stagger')) {
        (el as HTMLElement).style.transitionDelay = `${index * 0.1}s`;
      }
      observer.observe(el);
    });
  });

  // Parallax scroll effect
  let ticking = false;
  
  function updateParallax() {
    const scrolled = window.pageYOffset;
    const parallaxElements = document.querySelectorAll('.parallax');
    
    parallaxElements.forEach((el) => {
      const htmlEl = el as HTMLElement;
      const speed = htmlEl.dataset.speed || '0.5';
      const yPos = -(scrolled * parseFloat(speed));
      htmlEl.style.transform = `translateY(${yPos}px)`;
    });
    
    ticking = false;
  }

  window.addEventListener('scroll', () => {
    if (!ticking) {
      window.requestAnimationFrame(updateParallax);
      ticking = true;
    }
  });
</script>

<style is:global>
  /* Base states for scroll animations */
  .scroll-fade-in,
  .scroll-slide-up,
  .scroll-slide-left,
  .scroll-slide-right,
  .scroll-scale-in,
  .scroll-stagger {
    opacity: 0;
    transition: opacity 0.8s ease-out, transform 0.8s ease-out;
  }

  .scroll-slide-up {
    transform: translateY(50px);
  }

  .scroll-slide-left {
    transform: translateX(-50px);
  }

  .scroll-slide-right {
    transform: translateX(50px);
  }

  .scroll-scale-in {
    transform: scale(0.9);
  }

  /* Animated state */
  .scroll-fade-in.animate-in,
  .scroll-slide-up.animate-in,
  .scroll-slide-left.animate-in,
  .scroll-slide-right.animate-in,
  .scroll-scale-in.animate-in,
  .scroll-stagger.animate-in {
    opacity: 1;
    transform: translateY(0) translateX(0) scale(1);
  }

  /* Smooth scroll behavior */
  html {
    scroll-behavior: smooth;
  }

  /* Parallax container */
  .parallax {
    will-change: transform;
  }

  /* Reveal animation for text */
  @keyframes reveal {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .reveal-text {
    animation: reveal 1s ease-out forwards;
  }

  /* Stagger children animation */
  .stagger-children > * {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }

  .stagger-children.animate-in > * {
    opacity: 1;
    transform: translateY(0);
  }

  .stagger-children.animate-in > *:nth-child(1) { transition-delay: 0.1s; }
  .stagger-children.animate-in > *:nth-child(2) { transition-delay: 0.2s; }
  .stagger-children.animate-in > *:nth-child(3) { transition-delay: 0.3s; }
  .stagger-children.animate-in > *:nth-child(4) { transition-delay: 0.4s; }
  .stagger-children.animate-in > *:nth-child(5) { transition-delay: 0.5s; }
  .stagger-children.animate-in > *:nth-child(6) { transition-delay: 0.6s; }
  .stagger-children.animate-in > *:nth-child(7) { transition-delay: 0.7s; }
  .stagger-children.animate-in > *:nth-child(8) { transition-delay: 0.8s; }

  /* Fade in on scroll with blur */
  .scroll-blur-in {
    opacity: 0;
    filter: blur(10px);
    transition: opacity 1s ease-out, filter 1s ease-out;
  }

  .scroll-blur-in.animate-in {
    opacity: 1;
    filter: blur(0);
  }
</style>
